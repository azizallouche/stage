{% extends 'base.html.twig' %}
{% block body %}
    <link rel="stylesheet" href="../../public/assets/css/style.scss">
    <main>
     <div style="display: flex;position: relative;">
         <div style="margin-left: 270px;"><h1>Tasks</h1></div>
         <div style="margin-left: 300px;"><div class="search1">
                 <i class='bx bx-search'></i>
                 <input type="text" class="" id="search" placeholder="Quick Search ...">
             </div></div>
         <div style="margin-left:390px; margin-top: 20px;" onclick="funcreturn()"><ul class="return" ><li class="prev"><span></span></li></ul></div>
     </div>



        <div class="todo-container row" style="margin-left:300px;">
            <div class="status" id="no_status" style="background-color: #fff;">
                <h2 style="margin-bottom:30px;color: #3d5af1; ">&nbsp;&nbsp;&nbsp;&nbsp;No Status</h2>

            </div>
            <div class="status"  id="not_started"style="background-color: #fff;">

                <h2 style="margin-bottom:30px;color: #3d5af1;">&nbsp;&nbsp;Not Started</h2>

            </div>
            <div class="status" id="in_progress" style="background-color: #fff;">

                <h2 style="margin-bottom:30px;color: #3d5af1;">&nbsp;&nbsp;In Progress</h2>

            </div>
            <div class="status" id="completed" style="background-color: #fff;">

                <h2 style="margin-bottom:30px;color: #3d5af1;">&nbsp;&nbsp;Completed</h2>

            </div>
        </div>


        <p class="copyright" style="margin-left:240px;">
            &copy; 2021 - <span>Aqumex</span> All Rights Reserved.
        </p>
    </main>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">



        $( document ).ready(function() {
var id="";
            $.ajax({
                /* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                'async': false,
                'global': false,
                'url': "http://127.0.0.1:8000/api/users?email="+document.getElementById("ses").textContent,

                'dataType': "json",
                /*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                'success' : function(retour){
                    if(retour){
                        $.each(retour, function(i, obj) {
                          id= obj.idDev.idUser.idUser;

                        });
                    }
                    //$('#t tbody#search').append('<tr><td> '+obj.lieu+'  </td><td>    '+obj.nbPlace+'  </td><td>'+obj.descriptions+' </td><td>'+obj.dateEvent+' </td><td>'+obj.getcategory+' </td><td>'+obj.Description+'</td><td><td><a href="event/'+obj.idEvent+'/edit">Modifier</a></td></tr>');
                    else
                    {

                    }
                },
            });
            /* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
            var value = $(this).val();
            /* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */
            $.ajax({
                /* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                'async': false,
                'global': false,
                'url': "http://127.0.0.1:8000/api/ticketfrees.json",
                'dataType': "json",
                /*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                'success' : function(retour){
                    if(retour){

                        $.each(retour, function(i, obj) {


                            console.log(id);

                            if(obj.state == "no_status") {
                                $('#no_status').append("<div class=\"todo\" id =\"no_status" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong style=\"font-size: 14px;visibility: hidden;\" >"+obj.size+"h </strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "not_started"){
                                $('#not_started').append("<div class=\"todo\" id =\"not_started" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong style=\"font-size: 18px;\">&nbsp;&nbsp;" + obj.feature + "</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong style=\"font-size: 14px;\" >"+obj.size+"h </strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "in_progress"){
                                $('#in_progress').append("<div class=\"todo\" id =\"in_progress" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "completed"){
                                $('#completed').append("<div class=\"todo\" id =\"completed" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                        });
                        const todos = document.querySelectorAll(".todo");
                        todos.forEach((todo) => {
                            todo.addEventListener("dragstart", dragStart);
                            todo.addEventListener("dragend", dragEnd);
                        });}
                    //$('#t tbody#search').append('<tr><td> '+obj.lieu+'  </td><td>    '+obj.nbPlace+'  </td><td>'+obj.descriptions+' </td><td>'+obj.dateEvent+' </td><td>'+obj.getcategory+' </td><td>'+obj.Description+'</td><td><td><a href="event/'+obj.idEvent+'/edit">Modifier</a></td></tr>');
                    else
                    {

                    }
                },
            });
        });



    </script>
    <script type="text/javascript">





        $("#search").keyup(function(e) {


            /* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
            var value = $(this).val();
            /* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */
            $.ajax({
                /* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                'async': false,
                'global': false,
                'url': "http://127.0.0.1:8000/api/ticketfrees?feature="+value,

                'dataType': "json",
                /*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                'success' : function(retour){
                    if(retour){
                        $('#not_started').empty();
                        $('#no_status').empty();
                        $('#in_progress').empty();
                        $('#completed').empty();
                        $('#not_started').append("<h2 style=\"margin-bottom:30px;color: #3d5af1; \">&nbsp;&nbsp;Not Started</h2>");
                        $('#no_status').append("<h2 style=\"margin-bottom:30px;color: #3d5af1; \">&nbsp;&nbsp;&nbsp;&nbsp;No Status</h2>");
                        $('#in_progress').append("<h2 style=\"margin-bottom:30px;color: #3d5af1; \">&nbsp;&nbsp;In Progress</h2>");
                        $('#completed').append("<h2 style=\"margin-bottom:30px;color: #3d5af1; \">&nbsp;&nbsp;Completed</h2>");

                        $.each(retour, function(i, obj) {


                            console.log(retour);

                            if(obj.state == "no_status") {
                                $('#no_status').append("<div class=\"todo\" id =\"no_status" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "not_started"){
                                $('#not_started').append("<div class=\"todo\" id =\"not_started" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "in_progress"){
                                $('#in_progress').append("<div class=\"todo\" id =\"in_progress" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                            else if (obj.state == "completed"){
                                $('#completed').append("<div class=\"todo\" id =\"completed" + obj.idTicket + "\"  draggable=\"true\" > <div class=\"card mb-5 mb-lg-0\" > <div  class=\"aa\"> <ul style=\"list-style-type: none;\"> <li class=\"name\" ><strong>&nbsp;&nbsp;" + obj.feature + "</strong></li> <li class=\"name1\">Assigned By <strong>" + obj.assignedBy + "</strong></li> </ul> </div> </div> </div>");
                            }
                        });
                        const todos = document.querySelectorAll(".todo");
                        todos.forEach((todo) => {
                            todo.addEventListener("dragstart", dragStart);
                            todo.addEventListener("dragend", dragEnd);
                        });}
                    //$('#t tbody#search').append('<tr><td> '+obj.lieu+'  </td><td>    '+obj.nbPlace+'  </td><td>'+obj.descriptions+' </td><td>'+obj.dateEvent+' </td><td>'+obj.getcategory+' </td><td>'+obj.Description+'</td><td><td><a href="event/'+obj.idEvent+'/edit">Modifier</a></td></tr>');
                    else
                    {

                    }
                },
            });

        });

    </script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

{% endblock %}